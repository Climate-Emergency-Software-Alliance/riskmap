<template>
  <require from="./landing.css"></require>
  <require from="leaflet/leaflet.css"></require>
  <require from="../../components/disaster-map/disaster-map"></require>
  <require from="../../components/report-info/report-info"></require>
  <require from="../../components/side-pane/side-pane"></require>

  <div id="pageWrapper">
    <div id="screen">
      <div id="cityPopup">
        <p>Select city to load flood data:</p>
        <label repeat.for="city of mapModel.cities">
          <input type="radio" model.bind="city" selected.two-way="mapModel.selcity" change.delegate="mapModel.viewReports(city, true)">
          ${city}
          <br>
        </label>
      </div>
    </div>

    <disaster-map id="map" view-model.ref="mapModel" selcity.two-way="selected_city" reportid.two-way="report_id">
    </disaster-map>

    <div id="topBar">
      <div id="logo_top">
        <a href="map">
          <img id="pbLogo" src="assets/graphics/Peta_logo_noSub.svg" width="180">
        </a>
      </div>
      <div class="menuBtn active" click.delegate="mapModel.togglePane('#sidePane', 'show', true)">
        <i class="icon-menu"></i>
      </div>
      <div class="menuBtn" id="closeSidePane" click.delegate="mapModel.togglePane('#sidePane', 'hide', false)">
        <i class="icon-cancel-2"></i>
      </div>
    </div>

    <div id="logo_bottom">
      <a href="http://urbanrisklab.org">
        <img id="mitLogo" src="assets/graphics/URL_logo.svg" width="180">
      </a>
    </div>

    <div id="reportPane" class="popupPane">
      <div class="closeBtn" click.delegate="mapModel.togglePane('#reportPane', 'hide', false)">
        <i class="icon-cancel-2" aria-hidden="true"></i>
      </div>
      <report-info id="preview" if.bind="mapModel.layers.popupContent.pkey" pkey.bind="mapModel.layers.popupContent.pkey" city.bind="city_name" imageurl.bind="mapModel.layers.popupContent.image_url" height.bind="mapModel.layers.popupContent.report_data.flood_depth" title.bind="mapModel.layers.popupContent.title" text.bind="mapModel.layers.popupContent.text" time.bind="mapModel.layers.popupContent.created_at" currenttime.bind="timeNow" timestamp.bind="mapModel.layers.popupContent.timestamp">
      </report-info>
    </div>

    <div id="chartPane" class="popupPane">
      <div class="closeBtn" click.delegate="mapModel.togglePane('#chartPane', 'hide', false)">
        <i class="icon-cancel-2" aria-hidden="true"></i>
      </div>
      <div id="chart-title"></div>
      <div id="chart-pane"></div>
    </div>

    <div id="sidePane" class="popupPane">
      <side-pane cities.bind="mapModel.cities" selected.two-way="mapModel.selcity" change-city.call="mapModel.viewReports($event, $event)" close-pane.call="mapModel.togglePane('#sidePane', 'hide', false)" reportId="report_id">
      </side-pane>
    </div>
  </div>
</template>
